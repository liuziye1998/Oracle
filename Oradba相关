windows下启动数据库
    sqlplus /nolog 没有任何连接状态
    conn 用户名/密码 连接到数据库中

Linux下启动数据库
    sqlplus /nolog 无连接状态打开SQLplus
    conn /as dba 用dba身份连接
    startup启动数据库
    conn 用户名/密码  连接到数据库

conn 用户名/密码 as sysdba 以数据库管理员的身份连接数据库

用户
给用户名解锁
    alter user 用户名 account unlock

查看当前用户的所有表
    select table_name from user_tables;

查看数据库所有用户的用户信息
    dba_users;
    select * from dba_users;

查看当前用的用户信息
    user_users;
    select * from user_users;
 
创建用户
    create user 用户名 identified by 密码 default tablespace 表空间名称 temporary tablespace 临时表空间名

修改用户信息
    alter user 用户名 identified by 密码 default tablespace 表空间名称 temporary tablespace 临时表空间名

查看创建的用户
    select username from dba_users;

更改密码
    alter user 用户名 identified by 新密码

锁定用户
    alter user 用户名 account lock;

解锁用户
    alter user 用户名 account unlock;

删除用户
    drop user 用户名 cascade;
    cascade表示将用户连同其创建的东西去全部删除

修改用户所属的表空间
    alter user 用户名 default/temporary tablespace 表空间名称;




三种权限等级
    connect
    resource
    dba

查询系统权限
    select * from system_privilege_map;
    常用的有以下权限
        create session：创建会话
        create sequence：创建序列
        create table：创建表
        create user：创建用户
        create view：创建视图
        alter user：更改用户
        drop user：删除用户 

给用户授权
    grant 权限,权限2 to 用户1/角色1，用户2/角色2，public（表示全部用户）

回收权限
    revoke 权限 from 用户/public
    revoke 权限 from 角色

对象：例如表
查询所有Oracle对象权限
    select * from table__privilege_map;

将操作对象的某些权限/所有权限授权给用户或者角色
    grant 对象权限/所有对象权限 on 对象名 to 用户/全部用户/角色
        对象名要指定清楚，比如某某用户的某某表 system.temp system用户下的temp表     

将对象的相关权限撤销
    revoke 对象权限 on 对象名 from 用户/全部用户/角色


角色：可以理解为多个权限的集合

创建角色
    create role 角色

删除角色
    drop rolo 角色名

角色授权
    grant 权限 to 角色

将角色赋予用户
    grant 角色 to 用户

将用户的角色撤销
    revoke 角色名 from 用户




表空间
创建表空间
    1.create tablespace test_tablespace(表空间名称) datafile 'testfile.dbf（表空间实际存放的位置）' size 10m（表空间大小）; 
    2.create tablespace test_tablespace(表空间名称) datafile 'testfile.dbf（表空间实际存放的位置）' 
    (extent management local默认为本地管理表空间，可不输入) size 10m（表空间大小） uniform size 1m(数据库扩展默认大小);
创建临时表空间
    create temporary tablespace temp_tablespace tempfile 'tempfile.dbf' size 10m;   

向表空间增加数据文件
    alter tablespace 表空间名称 add datafile(注意是datafile不是tempfile) '数据文件名称以.dbf结尾' size 10m;

从表空间内删除数据文件
    alter tablespace 表空间名称 drop datafile '数据文件名称'
        注意：不能删除表空间的第一个创建的数据文件，如果需要删除，就需要删除整个的表空间

删除表空间
    drop tablespace 表空间名 （可选参数including contents,add datafiles,cascade constraints）
    drop tablespace 表空间名 including contects 删除表空间中的所有区段(EXTENTS)  
    drop tablespace 表空间名 add datafiles 删除表空间中的数据文件，文件格式为oracle格式
    drop tablespace 表空间名 cascade constraints删除和该表空间中的表相关的引用完整性约束

修改表空间大小
    1.向表空间增加数据文件
        alter tablespace 表空间名称 add datafile(注意是datafile不是tempfile) '数据文件名称以.dbf结尾' size 10m;
    2.创建时使用autoextend on 语句使表空间自动扩展
        create tablespace test_tablespace(表空间名称) datafile 'testfile.dbf（表空间实际存放的位置）' 
        (extent management local默认为本地管理表空间，可不输入) size 10m（表空间大小） autoextend on;
    3.创建之后修改为autoextend on自动扩展
        alter database datafile 文件名 autoextend on ;
    4.修改数据文件大小，即重新设置表空间中某个数据文件的大小
        alter database datafile 数据文件路径 resize 100m;


修改用户所属的表空间
    alter user 用户名 default/temporary tablespace 表空间名称;

修改表空间的状态
 
 1.连接或脱机状态
    alter tablespace 表空间名称 online/offline:
        online：表示联机状态
        offline：表示脱机状态
    alter tablespace user online/offline;
        将user表空间设置为联机或者脱机状态
    select status from dba_tablespaces where tablespace_name = '表空间名（名称必须大写）';
        查看系统管理员表空间中user的状态

    以下情况需要将表空间设为脱机状态
        允许用户访问数据库的一部分，某些表空间不允许访问
        执行脱机的表空间备份
        在数据库打开时，恢复表空间或表空间中的数据文件
        在数据库打开时，移动表空间中的数据文件

2.只读和可读写状态
    read only 只读状态
    read write  读写状态
    alter tablespace 表空间名称 read only/read write;
    alter tablespace user read only/read write
        将表空间user设为只读或者读写状态

查看表空间
    select tablespace_name from dba_tablespaces;
查看表空间存储的位置
    dba_data_files 存放数据库数据文件
    select file_name from dba_data_files where tablespace_name = '表空间名（名称必须大写）';

查看临时表空间存储位置
    select file_name from dba_temp_files where tablespace_name = '表空间名（名称必须大写）';
查询所有表空间的详细信息
    系统管理员：select tablespace_name from dba_tablespaces;
    用户：select tablespace_name from user_tablespaces;


启动数据库
    conn /as sysdba 以数据库管理员身份连接
        三种主要连接模式
            nomount状态：只打开数据库实例
            mount状态：根据参数文件中控制文件的位置，找到并打开控制文件，读取各种参数信息
            open状态：打开数据文件并进行一系列的检查工作，这些检查工作用于数据恢复
                open read only：只读模式打开数据库
                open read write：读写模式打开数据库（默认情况下）
        其他连接模式
            force：若数据库已启动并不会报错，而是自动shuntdown abort当数据库，然后在启动
            restrict：此模式启动，只有拥有restricted session 权限的用户才能登陆数据库
            pfile：从指定的参数文件启动数据库
    startup nomount
        从mount状态切换到其他状态
            alter database mount;切换到mount状态
            alter database open;切换到open状态
    从静态文件启动数据库
        startup pfile='文件所在路径'



关闭数据库
    1.SHUTDOWN ABORT
		此模式用于紧急情况，如其他形式的关闭方式都未能成功时。这种模式的关闭是最快的。但是，随后打开该数据库可能时间会显著增加因为必须执
	行实例恢复以使数据文件一致
		注意因为 SHUTDOWN ABORT 不对打开的数据文件执行检查点操作，所以在重新打开数据库之前，必须进行实例恢复
	2.SHUTDOWN IMMEDIATE(常用关闭方式)
		这种模式通常是除 SHUTDOWN ABORT 之外最快的关闭模式了。Oracle 数据库终止任何正在执行的 SQL 语句，并断开用户连接。所有活动事务都将
	终止，并回滚所有未提交的更改。
	3.SHUTDOWN TRANSACTIONAL
		这种模式可以防止用户启动新事务，但在关闭之前会等待所有的当前事务完成。这种模式可能会花费相当长的时间，这取决于当前事务的特征。
	4.SHUTDIWN NORMAL（默认连接方式）
		这是默认的关闭模式。在关闭之前数据库会等待所有连接的用户断开连接。

移动控制文件，磁盘故障时
    使用spfile启动数据库时如何移动控制文件
    1 获取控制文件名
        select status,name from v$controlfile;
    2 使用alter system set指令修改spfile中控制文件名
            alter system set control_files='C:\oracle\backup\CONTROL01.CTL'（新地址）,
            'C:\oracle\backup\CONTROL02.CTL' scope=spfile;修改信息记录在spfile中
    3 关闭数据库
        shutdown immediate 
    4 控制文件到迁移目录
        host copy D:\APP\SUNGL\ORADATA\ORACLE\CONTROL01.CTL(原地址) C:\oracle\backup\CONTROL01.CTL(新地址)
        host copy D:\APP\SUNGL\ORADATA\ORACLE\CONTROL01.CTL C:\oracle\backup\CONTROL02.CTL
    5 重启数据库
        startup
    6 验证修改结果

备份控制文件    备份文件不是最新的，在恢复数据库时最好不要使用备份文件以防数据丢失，
    方法一
        alter database backup controlfile to '备份后的控制文件所在地址，以.ora结尾';
    方法二(将控制文件备份到追踪文件)
        查看参数sql_trace是否为true(该参数默认为false,备份完成之后将值重新设为false，以避免不必要的性能浪费);
            show parameter sql_trace;
            设置为true
            alter system set sql_trace = true ;
        执行备份
            alter database backup controlfile to trace;
        查看备份目录
            show parameter user_dump_dest;
        打开上面的目录去寻找备份文件
            找到alter_oracle,查看最后几行找到backup，backup所指向的就是备份的控制文件的名称

恢复控制文件
    部分控制文件丢失或损坏的情况
        若数据库正在运行，先关闭数据库，再将完好的控制文件复制到已丢失或出错的控制文件的位置，要将新文件的名称和旧文件的名称保持
    一致
        若存储控制文件的目录结构也被破坏，则需要重新建立一个目录用于存放控制文件，并为该控制文件命名，此时需要修改数据库初始化参数
    文件文件中控制文件的位置信息。
            使用alter system set指令修改spfile中控制文件信息
                （alter system set control_files='C:\oracle\backup\CONTROL01.CTL','C:\oracle\backup\CONTROL02.CTL' 
            scope=spfile;修改信息记录在spfile中）

    控制文件全部丢失或损坏    此情况使用备份的控制文件来重建控制文件
        关闭数据库，将备份的数据文件复制到损坏的控制文件的位置，并将文件名修改为已损坏的文件名
            打开数据库到mount状态startup mount;再切换到open状态 alter database open
        此方法会造成一定程度的数据丢失，勤备份！

    通过跟踪文件重建控制文件
        跟踪文件中记录了用于建立控制文件的sql语句适当的编辑跟踪文件，然后用sql指令重建控制文件，创建控制文件成功后要进行数据库恢复
    即recover database 并在打开数据库后创建一个临时表空间用于数据排列

数据文件：
    查询数据文件
        select file_name from dba_data_files

控制文件
    是一个二进制文件，记录了数据库的状态信息，如重做日志文件与数据文件的名字和位置，归档重做日志的历史等，归档日志的历史记录会让该
文件逐渐变大，但其大小不会超过64MB，控制文件和数据库是一一对应的关系
    查看控制文件位置信息的方法
        select value from V$parameter where name='control_files';
        show parameter control_files;
    查看控制文件所存储的信息
        select * from V$controlfile_record_section;
    
    常用的从控制文件中读取数据的数据字典
        V$database：数据库信息
        V$instance：实例信息
        V$tablespace：表空间信息
        V$backup：备份信息
        V$tempfile：临时信息
        V$archive：归档信息
        V$log：日志信息
        V$logfile：日志文件
        V$loglist
        V$archived_log：归档日志信息

参数文件
    静态文件pfile：静态的正文件，可以使用文本编辑器编辑
        从spfile创建pfile
            create pfile from spfile
        从内存中创建pflie
            create pfile from memory 
    spfile文件：动态的二进制文件，只能通过Oracle的指令修改
        alter system 指令来修改参数值
        Windows默认名称为spfile(数据库名称).oracle
        unix默认名称为spfile数据库名.ora

        show parameter spfile 
            1 查看动态参数文件的位置
            2 若value值为空则为pfile启动反之则为spfile启动

        从pfile创建spfile
            先从spfile创建一个pfile
                create pfile from spfile
            修改pfile之后再创建spfile
                使用pfile默认目录名
                    create spfile from pfile
                不使用pfile默认目录名
                    create spfile from pfile = 'pfile文件名'
        从内存中创建spflie
            create spfile from memory 

    数据库初始化参数组成及查看方法
        初始化参数由一系列的参数/参数值对组成 参数db_name='orcl',db_name为参数名，orcl为参数值
        使用show parameter 参数名 查看参数和参数值
        使用数据字典v$parameter查看参数值 select value from v$parameter where name = '参数名';

    修改参数值
        alter system set 参数名 = 参数值 （可选参数有 comment = 'text'（对参数的描述），
    deferred(修改是否立即生效 deferred表示下次会话时生效) scope=memory只对当前实例生效|spfile下次连接时生效|both前面两个都生效）

    oracle11g中默认使用spfile启动数据库，此时pfile至是一个模板信息，不可用，必须创建一个可用的pfile文件才能使用
        create pfile from spfile
        静态文件的默认位置在Oracle安装目录下的admin/oracle_sid（数据库的名称）/pfile文件夹下

重做日志文件信息

    添加一个重做日志组
        alter database add logfile 日志组名称 ('日志组文件存放路径以.log结尾','') size 10m;
    向重做日志组中添加成员
        alter database add logfile member '文件路径以.log结尾' to 组名,'文件路径以.log结尾' to 组名;
        
    删除一个重做日志组(当前正在使用的日志组无法删除)
        alter database drop logfile 日志组名称;
    删除重做日志组成员(当前正在使用的日志组成员无法删除)
        alter database drop logfile member '文件路径以.log结尾' to 组名,'
    删除重做日志文件中的所有数据
        alter database clear logfile 组名;

    强制启动检查点
        alter system checkponit;
    切换正在使用的日志组
        alter system switch logfile;
    更改日志组的大小
        通过删除日志文件所在的日志组，然后重建日志文件，用这种间接的方式更改日志组的大小

    V$log查看重做日志信息
        select * from V$log;
    V$lofile查看重做日志存放位置信息
        select * from V$logfile
    判断数据库是否处于归档模式
        archive log list;
    设置数据库处于归档模式方法
        1.关闭数据库
            shutdown IMMDEIATE
        2.启动数据库到mount状态
            startup mount;
        3.设置数据库为归档模式
            alter database archivelog;
        4.打开数据库到
            alter database open;
    


还原段
    系统还原段为系统表空间使用，非系统还原段为用户创建的表空间使用

    自动还原段管理
        undo_managment：说明还原段的管理方式
        undo_tablespace：说明还原表空间的名字
    创建还原表空间
        create undo tablespace 还原表空间名 datafile '文件路径以.dbf结尾' size 100m autoextend on ;
    向表空间中添加数据文件
        alter tablespace 表空间名 add datafile '文件路径以.dbf结尾' size 10m;

    删除还原表空间（要删除的表空间不应处于使用或工作状态）
        drop tablespace 表空间名
    
    重命名还原表空间
        alter tablespace 旧名 rename to 新名
    设置还原表空间为自动扩展
        alter database datafile '文件路径以.dbf结尾' autoextend on;

    查看还原表空间信息
        select * from dba_tablespaces where contents='UNDO';
    查看当前使用的还原段和相关参数
        show parameter undo 
    切换还原表空间
        alter system set undo_tablespace=还原表空间名

    undo_retention参数：
        该参数是一个时间值，说明当事务提交完成之后，在多长时间内此数据仍然存在于还原表空间中，如果时间过长且修改
        数据的事务很多，会造成还原表空间的不足。
    修改undo_retention的值
        alter system set undo_retention=1200（默认单位为秒）;
        通过show parameter undo 参数验证结果
        


exp备份数据库(导出)
    exp使用程序可以导出整个数据库，一个用户的所有对象，一个表空间或特定的表，使用exp导出的数据
    必须使用IMP恢复/导入

    常用参数
        1.userid：无默认值，说明登陆数据库的用户名和密码
        2.buffer：指定数据缓冲区的大小
        3.file：将备份的数据文件重命名，若不命名则默认为expdat.dmp或EXPDAT.DMP 
        4.compress：该参数默认值为Y或N，使Oracle对导出的数据进行配置
        5.grants：默认值为Y或N。控制授权的导出
        6.indexes：默认值为Y或N，控制索引的导出
        7.log：该参数说明在导出备份时，是否需要创建一个备份日志，来记录整个备份过程
        8.full：说明是否导出整个数据库的所有对象，默认值为Y或N，如果全部导出，则连接的用户必须具有dba权限才行
        9.tables：若该表是当前连接的用户所有，则直接输入表名，否则输入模式名和表名。若有多个则用逗号隔开，
        10.owner：说明要导出特定用户的数据库对象
        11.trigger：默认值为Y或N，说明是否导出用户下的触发器
        12.statistics：该参数值为estimate,computer,none指出产生的对象的统计方式，若选择estimate，computer
        则以该方式计算统计量，none表示不使用统计量
        13.constraint：默认值为Y或N 说明是否导出约束
        14.feedback：每隔一定行数显示备份进展情况，该参数值为0到n的任何有效数字
        15.filesize：设置每个转储文件的最大值
        16.tablespace：说明要导出的表空间名称
        17.resumable：该参数的值为Y或N指出exp是否使用Oracle的可恢复空间管理工具，使用该工具导出数据时，如发生与空间
        相关的错误应终止导出
    导出整个数据库
        D:\>exp liu/oracle@oracle full=y(全部导出) file=backup_testdata.dmp(导出到本地的文件名))
    导出整个数据库结构，不导出数据
        D:\>exp liu/oracle@oracle full=y row=n（使用此参数） file=backup_testdata.dmp
    导出特定用户的表(若需要导出的不是当前用户的表则需要使用username.tablename的形式说明该表属于哪个用户)
        D:\>exp liu/oracle@oracle tables=socct.dept file=backup_testdata.dmp
    导出当前用户的表
        D:\>exp liu/oracle@oracle table=dept(只导出dept表) file=table.dmp
    导出指定用户的所有数据（导出指定的用户）
        D:\>exp liu/oracle@oracle owner=scott(用户名) file=backup_testdata.dmp
    导出特定的表空间
        D:\>exp liu/oracle@oracle tablespaces=表空间名 file=backup_testdata.dmp
    

imp恢复数据库(导入)
    导入通过exp指令导出的备份数据，imp可以导入一个完整的数据库，一个指定的用户的所有数据库对象，一个特定的表空间和一个特定的表
    常用参数
        1.userid：说明登录数据库的用户名和密码
        2.buffer：说明输入数据缓冲区的大小
        3.file：说明exp程序创建的备份名，有时需要绝对路径
        4.show：导入过程中是否显示备份文件的内容
        5.ignore：是否忽略在导入备份过程中的错误
        6.grants：是否导入备份文件中的授权
        7.indexes：是否导入索引
        8.rows：是否导入数据，默认参数为Y或N，若为N则不输入数据
        9.log：是否将导入过程记录到日志文件中
        10.full：将整个备份文件导入
        11.formuser：允许将一个备份文件中的对象从一个用户复制到另一个用户，该参数说明数据的源用户
        12.touser：允许将一个备份文件中的对象从一个用户复制到另一个用户，该参数说明数据的目标用户
        13.tables：说明要导入的表名
        14.skip_unusable_indexes：该参数默认值为Y或N，说明是否需要重建已经设置为unuable状态的索引
        15.statistics：说明在导入对象后对统计量的处理，参数为always(从备份文件中导入统计量)，none(不做任何动作),
        safe(如果使用可靠的优化器，则允许导入优化器统计量)),recalsulate(重新计统计量，而不是从备份文件中导入统计量)
        16.constraints：说明是否导入备份数据中的约束
        17.compile：说明是否引入进程来编译过程，包和函数

    恢复整个数据库（导入整个数据库）
        D:\>imp liu/oracle@oracle full=y file=backup_testdata.dmp ignore=y(忽略导入过程中的错误)
    恢复特定的表
         D:\>imp liu/oracle@oracle ftables=表名  file=backup_testdata.dmp 
    恢复指定的用户
         D:\>imp liu/oracle@oracle full=y file=backup_testdata.dmp（该用户的备份文件）
    导入指定的表到指定的用户(将Scott用户的emp表导入到system用户中，即在system用户中创建一个表，然后将数据插入)
         D:\>imp liu/oracle@oracle tables=emp fromuser=scott touser=system file=backup_testdata.dmp 



数据泵(是imp和exp程序的扩展)

    与imp和exp程序的区别
        1.更快的速度，更大的数据量
        2.数据泵技术基于数据库服务器，在服务器段产生进程，并且将备份的数据备份在数据库服务器中
        3.不同于用户进程，更像一个控制进程，在客户端和服务器端建立会话，并控制整个备份过程
        4.传统imp和exp备份的数据格式与数据泵备份的数据格式不兼容
        5.使用数据泵导出数据前必须要先创建目录对象
        
    数据泵的优点
        1.更快的的速度，可并行作业
        2.重启失败的作业，手动停止作业或重启作业
        3.独立于客户机，数据泵技术是基于数据库服务器，是数据库服务器的一部分
        4.支持网络操作，在两个联网的数据库服务器直接导入导出数据文件，无需备份
        5.更加细化的导入导出

    查看dba用户默认的数据泵工作的目录
        select * from dba_directories where directory_name='DATA_PUMP_DIR';

    非dba用户需要创建数据泵的工作目录，创建方法如下
        1.登录dba用户，给用户授予创建目录的权限
            conn system/oracle 
            grant create any directory to 用户名;
        2.登录授权之后的用户，创建数据泵的工作目录
            conn 用户名/密码
            create directory 目录对象名 as '目录的路径';(操作系统不会自动创建此目录，须手动进行创建)

    导入IMPDP(服务器端实用导入程序)，将备份的数据导入到整个数据库，特定的模式，特定的表或特定的表空间，也可在不同平台的数据
库之间迁移表空间 SQLFILE是其专有参数
    导入参数
        1.目录和文件相关参数
            directory：说明备份文件，日志文件和SQL文件的目录对象，若无定义目录则使用pump_dir的默认值
            dumpfile：说明备份文件名，如要导入多个备份文件，则用逗号分隔这些文件名
            parfile：说明参数文件的位置
            logfile：使用日志文件保存导入过程的信息，该参数的值为日志文件的名称（即用该日志文件记录）
            nologfile：不使用日志文件保存导入过程
            SQLfile：从备份文件中提取SQL的DDL语句，并写入到该参数设置的文件中
        2.过滤参数
            include：说明要导入的特定对象，如有多个使用逗号隔开，如只导入表，此时会导入和表有依赖关系的对象，如索引，触发器等
                include=table:"in ('emp',dept)"只导入这两个表

            table_exits_action：若导入的表已存在时，设置IMPDP的行为，其有四个值，skip表示若存在该表就跳过(默认值) 
            append将导入的数据附加到当前存在的表中，truncate,截断表并从导入数据中重新装载数据
            replace删除存在的表后重建并导入数据

            exclude：排除特定的对象
        
        3.导入作业参数
            job_name：说明导入作业名
            prallel：说明当前导入作业的线程数，默认为1
            status：监视导入作业的频率，默认值为0

        4.导入方式参数
            tables：允许导入指定的表，如有多个使用逗号隔开，会导入和表有依赖关系的对象，如索引，触发器等
            schemas：说明要导入的模式(用户所拥有的数据库对象的集合)，要使用该参数，登录数据库的用户必须拥有imp_full_database的权限
                对象：包括索引，表，视图，函数，包，过程，同义词，序列，触发器
            query：过滤要导入的表数据，此时数据泵导入作业使用外部表数据的方法访问数据
            tablespaces：说明要导入的表空间的列表，同时也导入与表空间有依赖关系的所有数据库对象
            full：导入整个数据库，该参数默认值为n

        5.重新映射参数
            在数据导入过程中，将一个数据库对象移动到另一个数据库对象，可以映射模式，映射数据文件和表空间
        映射可以理解为数据对象移动
            remap_schema：重新映射模式，将对象从一个用户/模式移动到另一个用户/模式
                D:\>impdp system/oracle@orcl dumpfile=pump_dir:shcema_scott.dmp remap_schema=scott:linzi
                将Scott用户下的所有数据库对象移动到linzi用户下

            remap_datafile：导入数据是，重新定义数据文件的名称和目录
                D:\>impdp system/oracle@orcl directory=pump_dir 
                dumpfile=backup_full.dmp 
                remap_datafile='c:\mydbf'(旧名旧目录):'d:\mydbf\newdb.dbf(新名新目录)'
            remap_tablespace：重映射表空间使得将数据对象从一个表空间移动到另一个表空间
                D:\>impdp system/oracle@orcl remap_tablespace='users(旧表空间名)':'mynewusers(新表空间名，须为已有的)' 
                directory=pump dir dumpfile=backup_full.dmp

        6.转换参数
            Transfrom：导入数据泵作业时可以选择导入某个对象的存储参数或其他属性值
            transfrom=transfrom_name:value[:object_type]
                transfrom_name：有4个选项 segment_attributes段属性包括物理属性，存储参数，表空间等参数值为Y(为包含)或N
                    storage：是否导入对象的存储属性参数值为Y或N
                    OID：是否重新分配新的OID给对象表
                    pctspace：提供一个整数值，可以增加对象的分配尺寸
                value：transfrom的前三个参数值为y
                object_type：说明对象的类型
        
        7.闪回参数
            flashback_scn：使用Oracle的闪回特性，允许导入和闪回scn接近的数据
            flashback_time:使用Oracle的闪回特性，允许导入和指定闪回时间接近的数据

        8.与可移植表空间有关的参数：Oracle的可移植表空间是数据从一个数据库移动到另一个数据库中非常容易
            transfrom_tablespace：说明要迁移的表空间列表
            transfrom_full_check：迁移表空间时，检查迁移表空间内的对象和迁移表空间外的对象是否有依赖性，该参数只有使
            用network_link参数时才有效
            transfrom_datafiles：执行表空间导入时，目标数据库使用源数据库中拷贝过来的数据文件作为可移植表空间的数据文件

        9.交互式参数
            parallel：说明当前作业的活跃worker数量
            continue_client：切换交互模式后，返回记录模式
            kill_job：分离或删除当前导入作业
            start_job：导入作业意外终止后，重启或恢复当前作业
            status：监视当前导入作业的状态，该参数为整数值，默认值为0，若设置为n则表示为n秒刷新一次导入作业状态信息
            stop_job：关闭当前执行的作业并退出客户端，若有多个则顺序退出，若stop_job=immediate则立即关闭数据泵作业

        导入数据库
            D:\>impdp(操作系统下输入) system/oracle(用户名密码)@orcl
            dumpfile=pump_dir:full_db_%u.database(备份文件)
            logfile=myfulldb.log(日志文件) parallel=3(并行度)
            job_name=my_fulldb_impdp(工作名) full=y(全部导入)
        
        导入表空间
            D:\>impdp(操作系统下输入) system/oracle(用户名密码)@orcl
            dumpfile=pump_dir:MYDB_TBS_USERSANDSYSTEM_01.DAT logfile=log
            tablespace=users(表空间名) table_exits_action=replace(如果表空间存在，则删除后重建)

        导入特定的表
            D:\>impdp(操作系统下输入) system/oracle(用户名密码)@orcl
            dumpfile=pump_dir:MYDB_TBS_USERSANDSYSTEM_01.DAT nologfile=y tables=emp(表名))
            table_exits_action=replace

        导入指定的数据库对象
            D:\>impdp(操作系统下输入) scott/trgger(用户名密码)@orcl
            dumpfile=pump_dir:MYDB_TBS_USERSANDSYSTEM_01.DAT nologfile=y
            include=table,trugger
            table_exits_action=replace

    导出EXPDP(服务器端导出程序)，ADD_FILE是其专有参数，允许挂起和恢复作业，也支持从失败或终止的作业中重启，导出数据库对象的选择更加的细化，
并且提供并行处理，expdp支持两种数据访问的方法外部表和直接路径访问方法，expdp提供了三种提取数据的方法，一是只提取数据库中的 元数据，
二是只提取数据库中的数据，三是同时提取元数据和数据

    导出参数
        1.attach：连接到现有作业，格式为attach=作业名
        2.content：说明要导出的是元数据还是数据，参数为all,data_only,metadata_only
        3.directory：说明要导出的备份文件，日志文件和sql文件的存储目录，非dba用户需要提前设置该目录
        4.dumpfile：说明导出备份的文件名
        5.estimate：计算导出作业导出文件的大小，选项为blocks(基于数据库块大小的倍数计算备份文件大小)，
            statistics(使用当前对象的统计量来计算导出的备份文件的大小)
        6.estimate_only：只估计导出文件的大小，不进行实际的导出作业，参数为Y或N
        7.exclude：排除不需要导出的特定的对象
        8.flashback_scn：使用Oracle的闪回特性，使用规定的scn进行闪回
        9.full：说明是否导出整个数据库对象
        10.include：说明要导出的特定对象，如有多个使用逗号隔开，如只导出表，此时会导出和表有依赖关系的对象，如索引，触发器等
        11.job_name：说明导出作业名，命名格式为sys_operation(导入/导出)_mode(数据类型)_nm(编号)
            如导出scott用户的元数据"scott"."sys_export_schema_01"
        12.logfile：说明在导出时记录导出过程的日志文件名，默认名为export.log必须和导出文件保存在相同的目录下，即directory参数指定的目录
        13.parallel：设置可同时导出作业时最大的进程数，默认为1
        14.query：允许使用sql语句程序过滤导出的数据
        15.schemas：说明要导出的模式(用户所拥有的数据库对象的集合)，要使用该参数登录数据库的用户必须拥有exp_full_database的权限
             对象：包括索引，表，视图，函数，包，过程，同义词，序列，触发器
        16.status：监视导入作业的频率，默认值为0
        17.tables：说明要导出的表名,会导出与表有关系的对象
        18.tablespaces：说明要导出的表空间的列表，同时也导出与表空间有依赖关系的所有数据库对象
        19.version：将数据库对象导出到指定的数据库版本，解决数据库对象从高版本到低版本迁移时版本兼容的问题
    交互式参数
        1.add_file：向备份文件中添加文件以增加目录空间，解决因备份文件空间不足导致停止的问题
        2.stop_job：停止运行的数据泵作业，数据库服务器端的导出数据服务器进程终止
        3.start_job ：重新恢复意外停止的数据泵作业
        4.kill_job ：杀死客户机进程和数据泵作业
        5.continue_client：退出交互模式恢复正在运行的导出数据泵作业，实际的数据泵作业不受影响
        6.exit_client：停止交互式会话，实际的数据泵作业不受影响
    导入出整个数据库
        D:\>expdp system/oracle@oracle dumpfile=pump_dir(目录):mydb_%u.dat(文件名,若文件存储空间不足%u实现备份文件自动创建)
         filesize=100m nologfile=y job_name=tom full=y
    导入一个模式（没有schema参数，默认导出登录数据库时的模式对象）
        D:\>expdp scott/tiger@oracle directory=pump_dir（目录） dumpfile=scottschema.dmp 
        logfile=scottschema.log
    导出一个特定的表
        D:\>expdp system/oracle@oracle dumpfile=pump_dir:scott_tables_%u.dat tables=scott.emp,scott.dept
        nologfile=y job_name=only_scott
    导出特定的表空间
        D:\>expdp system/oracle@oracle dumpfile=pump_dir:user_tbs_%u.dmp tablespace=users(表空间名) filesize=100m
        paraller=2 logfile=users_tbs.log job_name=exp_users_tbs
    只导出数据行
        D:\>expdp system/oracle@oracle dumpfile=pump_dir:mydb_dataonly_%u.dat filesize=100m job_name=larry
        full=y content=data_only logfile=pump_dir:mydb_exp_dataonly_log
    使用参数文件导出或导入
        编辑参数文件并保存以.par结束
        使用参数文件 D:\>expdp scott/tiger@oracle parfile=参数文件的绝对路径
    计算导出数据库所需要的空间
        D:\>expdp system/oracle@oracle full=y estimate_only=y estimate=statistics nologfile=y


rman
    如果数据库处于open read write状态执行备份，数据库必须置于归档模式
    host命令可以暂时退出rman的操作台返回系统的操作台，系统控制台输入exit可切换回到rman的操作台
    备份类型：
        镜像复制：创建日志文件，数据文件，控制文件等的备份，等同于复制一份
        备份集：rman创建的具有特定格式的逻辑备份对象，备份集在逻辑上由一个或多个备份片段组成，每个片段在物理上对应一个操作系
    统文件，一个备份片段中可能包含多个数据文件，控制文件或归档文件，其优势在于备份时只读取数据库中已经使用的数据块，提升备份效率

    执行方式：以backup开始
        单个执行：rman> backup database;
        批处理：rman>run{......},将多个命令放在一起组成一个命令组，若其中任何一条命令执行失败则其后的所有命令都不被执行
        运行脚本
            1.用命令行调用操作系统中的脚本 D:\> rman /@脚本名称(或者 /cmdfile=脚本名称)))
            2.在rman中执行操作系统中的脚本 rman>@脚本名称
            3.运行存储在catalog中的脚本（需首先为rman创建恢复目录） rman>run{execute script 脚本名称}

    备份整个数据库(若数据库处于open read write 状态，数据库必须置于归档模式)
        backup database;(此命令默认将备份保存至Oracle的安装目录)
        backuo database format '路径'（通过format参数自定义路径和命名规则）
    查看全库备份
        list backup of database;
        
    备份表空间（只要实例处于加载状态，无论数据库是否打开都可以进行表空间的备份）
        backup tablespace 表空间名称;
        backup tablespace 表空间名称 format '路径'
    查看表空间备份
        list backup of tablespace 表空间名

    备份数据文件
        backup datafile '数据文件名称路径'/数据文件id
    查看数据文件备份
        list backup of datafile n（为数据文件id）

    备份控制文件  
        1.手动执行备份命令 backup current controlfile
        2.执行backup命令时指定include current controlfile子句 backup database include current controlfile 
            每一次备份任务的时候都会备份一次控制文件
        3.备份数据库的第一个数据文件,此时也会备份控制文件 backup datafile 1;
        4.通过configure命令将controlfile autobackup设置为on  configure controlfile autobackup on 
             每一次备份任务的时候都会备份一次控制文件
    查看控制文件备份
        list backup of controlfile 

    备份归档文件
        1. backup archivelog all;(all指备份当前所有可以访问到的归档文件)
        2. 执行backup命令时指定plus archivelog
            该语句会依次执行下列步骤
            1. 运行alter system archive log current 对当前重做日志文(redolog)件进行归档 
            2. 执行backup archivelog all命令备份所有已归档日志
            3. 对本次backup命令要备份的内容进行备份
            4. 再次运行alter system archive log current 对当前重做日志文(redolog)件进行归档 
            5. 将新产生的尚未备份的归档日志进行备份
            在backup命令后加入 delete all input 参数，会在完成备份之后自动删除已备份的归档日志，即删除上述过程中的第一次备份的文件
    查看归档文件的备份
        list backup of archivelog all;

    备份参数文件(备份控制文件时会自动备份)
        backup spfile;

    备份备份集
        backup backupset all;(备份所有备份集，该命令会直接复制当前的备份集，建立一个一模一样的备份集)

    rman常用命令
        1. show：通过show命令显示当前的配置参数 showshow all; 
        2. list：列出数据库中所有的备份信息 list backup；列出相对应的备份信息 list backup of ;列出所有无效备份list expired backup
        3. delete：删除备份记录及相应的物理文件
            删除过期备份：delete obslete
            删除无效备份：delete expired backup 删除expired副本：delete expired copy
            删除特定备份集：delete backupset 备份集id  删除特定的备份片 delete backuppiece

    report：对当前备份信息的分析
        report need backup ：查看所有需要备份的文件
        report need backup tablespace 表名称：查看指定的表空间是否需要备份
        report obslete ：查看过期备份

    crosscheck：用来检查备份或归档物理文件的状态，如果物理文件存在，并且控制文件或恢复目录中有匹配记录，则标记该对象状态为available(有效)
        若文件不存在，则标记该对象状态为expired（无效）
        crosscheck archivelog all 检查所有归档文件
        crosscheck backup 检查所有备份集

    change：修改备份文件或归档文件的状态，不是指物理文件而是这些文件在控制文件或恢复目录中对应记录的状态分别为available(可用),
    unavailable(不可用)
        change backup of tablespace users unavailable 修改指定表空间状态为不可用
        change archivelog logseq=n unavailable 修改指定归档文件状态为不可用
        change archivelog logseq=n delete 删除指定的归档文件


    
    



    删除指定的备份
        delete backupset bs关键字序号





